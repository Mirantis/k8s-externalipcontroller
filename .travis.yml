sudo: required
language: go
services:
    - docker
before_install:
  - mkdir -p _output/
  - sudo apt-get install -y git
install:
  - make get-deps
script: make test
after_success:
  - docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"
  - if [ "$TRAVIS_BRANCH" == "master" ]; then
        docker push mirantis/k8s-externalipcontroller:latest;
    fi
  - if [ ${TRAVIS_BRANCH:0:8} == "release-" ]; then
        docker tag mirantis/k8s-externalipcontroller mirantis/k8s-externalipcontroller:$TRAVIS_BRANCH;
        docker push mirantis/k8s-externalipcontroller:$TRAVIS_BRANCH;
    fi
